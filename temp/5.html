<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ophelia</title>
    <!-- Use Bootstrap 5 for modern look -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="./static/content/site.css" />
    <link rel="stylesheet" type="text/css" href="./static/content/Aspire.Dashboard.styles.css" />
    <link rel="stylesheet" type="text/css" href="./static/content/chatgptassist.css" />
</head>
<body>
    <!-- Navigation bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Ophelia</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"></button>
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item dropdown"></li>
                        <a class="nav-link dropdown-toggle" href="#" id="frameworksDropdown" role="button" 
                           data-bs-toggle="dropdown"></a>
                            Frameworks
                        </a>
                        <ul class="dropdown-menu"></ul>
                            <li><a class="dropdown-item" href="#" onclick="showSetupCommands('aspire')">Aspire</a></li>
                            <li><a class="dropdown-item" href="#" onclick="showSetupCommands('flask')">Flask</a></li>
                            <li><a class="dropdown-item" href="#" onclick="showSetupCommands('rust')">Rust</a></li>
                            <li><a class="dropdown-item" href="#" onclick="showSetupCommands('cmake')">CMake</a></li>
                            <li><a class="dropdown-item" href="#" onclick="showSetupCommands('react')">React</a></li>
                            <li><a class="dropdown-item" href="#" onclick="showSetupCommands('kubernetes')">Kubernetes</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Command Display Modal -->
    <div class="modal fade" id="commandModal" tabindex="-1" aria-labelledby="commandModalTitle" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-light">
                    <h5 class="modal-title" id="commandModalTitle">Setup Commands</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <pre class="bg-dark text-light p-3 rounded"><code id="commandModalContent"></code></pre>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="copyModalContent()">
                        <i class="bi bi-clipboard"></i> Copy Commands
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Copy Confirmation Modal -->
    <div class="modal fade" id="copyConfirmModal" tabindex="-1" aria-hidden="true"></div>
        <div class="modal-dialog modal-sm"></div>
            <div class="modal-content">
                <div class="modal-body"></div>
                    <p class="text-center mb-0 text-success"></p>
                        <i class="bi bi-check-circle-fill"></i> Commands copied!
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Modal -->
    <div class="modal fade" id="errorModal" tabindex="-1" aria-hidden="true"></div>
        <div class="modal-dialog modal-sm"></div>
            <div class="modal-content"></div>
                <div class="modal-header bg-danger text-white"></div>
                    <h5 class="modal-title">Error</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body"></div>
                    <p id="errorModalContent" class="text-center mb-0"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Modal instances
        let commandModal, copyConfirmModal, errorModal;

        // Initialize modals when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            commandModal = new bootstrap.Modal(document.getElementById('commandModal'));
            copyConfirmModal = new bootstrap.Modal(document.getElementById('copyConfirmModal'));
            errorModal = new bootstrap.Modal(document.getElementById('errorModal'));
        });

        // Show error in modal instead of alert
        function showError(message) {
            document.getElementById('errorModalContent').textContent = message;
            errorModal.show();
        }

        // Framework commands object
        const frameworkCommands = {
            'aspire': `Create new Aspire project:

dotnet new aspire-starter --name MyProject
cd MyProject
dotnet run`,
            'flask': `Create Flask project:

python -m venv venv
source venv/bin/activate  # or 'venv\\Scripts\\activate' on Windows
pip install flask
flask run`,
            'rust': `Create Rust project:

cargo new my_project
cd my_project
cargo build
cargo run`,
            'cmake': `Create CMake project:

mkdir build && cd build
cmake ..
make`,
            'react': `Create React project:

npm create vite@latest my-app -- --template react-ts
cd my-app
npm install
npm run dev`,
            'kubernetes': `Deploy to Kubernetes:

kubectl create namespace my-app
kubectl apply -f deployment.yaml
kubectl get pods -n my-app`
        };

        // Enhanced command display function
        function showCommands(title, commands) {
            const modalTitle = document.getElementById('commandModalTitle');
            const modalContent = document.getElementById('commandModalContent');
            
            modalTitle.textContent = title;
            modalContent.textContent = commands;
            commandModal.show();
        }

        // Show setup commands with validation
        function showSetupCommands(framework) {
            const normalizedFramework = framework.toLowerCase();
            if (frameworkCommands[normalizedFramework]) {
                showCommands(
                    `${framework} Setup Commands`,
                    frameworkCommands[normalizedFramework]
                );
            } else {
                showError(`Unknown framework: ${framework}`);
            }
        }

        // Improved copy functionality with error handling
        async function copyModalContent() {
            try {
                const content = document.getElementById('commandModalContent').textContent;
                await navigator.clipboard.writeText(content);
                commandModal.hide();
                copyConfirmModal.show();
                setTimeout(() => copyConfirmModal.hide(), 1500);
            } catch (err) {
                console.error('Failed to copy content:', err);
                showError('Failed to copy to clipboard. Please try again.');
            }
        }

        // Enhanced curl command copy
        async function copyCurlCommand(command) {
            try {
                await navigator.clipboard.writeText(command);
                copyConfirmModal.show();
                setTimeout(() => copyConfirmModal.hide(), 1500);
            } catch (err) {
                console.error('Failed to copy curl command:', err);
                showError('Failed to copy command. Please try again.');
            }
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Add Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</body>
</html>
